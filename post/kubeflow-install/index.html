<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>kubeflow安装教程 - YY小站</title>
<meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=Cache-Control content="no-transform"><meta http-equiv=Cache-Control content="no-siteapp"><meta name=theme-color content="#f8f5ec"><meta name=msapplication-navbutton-color content="#f8f5ec"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec"><meta name=author content="info@yanyong.cc"><meta name=description content="服务器和软件版本规划 7台服务器和1个虚拟IP： 172.27.244.151-153(3台master,4C/8G/500GB) 172.27."><meta name=keywords content="Hugo,theme,even"><meta name=generator content="Hugo 0.127.0 with theme even"><link rel=canonical href=https://yanyong.cc/post/kubeflow-install/><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/manifest.json><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script><link href=/sass/main.min.f92fd13721ddf72129410fd8250e73152cc6f2438082b6c0208dc24ee7c13fc4.css rel=stylesheet><link rel=stylesheet href=https://testingcf.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><meta property="og:url" content="https://yanyong.cc/post/kubeflow-install/"><meta property="og:site_name" content="YY小站"><meta property="og:title" content="kubeflow安装教程"><meta property="og:description" content="服务器和软件版本规划 7台服务器和1个虚拟IP： 172.27.244.151-153(3台master,4C/8G/500GB) 172.27."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-07-24T09:45:37+08:00"><meta property="article:modified_time" content="2023-07-24T09:45:37+08:00"><meta property="article:tag" content="Kubeflow"><meta itemprop=name content="kubeflow安装教程"><meta itemprop=description content="服务器和软件版本规划 7台服务器和1个虚拟IP： 172.27.244.151-153(3台master,4C/8G/500GB) 172.27."><meta itemprop=datePublished content="2023-07-24T09:45:37+08:00"><meta itemprop=dateModified content="2023-07-24T09:45:37+08:00"><meta itemprop=wordCount content="3880"><meta itemprop=keywords content="Kubeflow"><meta name=twitter:card content="summary"><meta name=twitter:title content="kubeflow安装教程"><meta name=twitter:description content="服务器和软件版本规划 7台服务器和1个虚拟IP： 172.27.244.151-153(3台master,4C/8G/500GB) 172.27."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=/ class=logo>YY小站</a></div><div class=mobile-navbar-icon><span></span>
<span></span>
<span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=/><li class=mobile-menu-item>首页</li></a><a href=/post/><li class=mobile-menu-item>归档</li></a><a href=/tags/><li class=mobile-menu-item>标签</li></a><a href=/categories/><li class=mobile-menu-item>分类</li></a><a href=/about/><li class=mobile-menu-item>关于</li></a><a href=/search/><li class=mobile-menu-item>搜索</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=/ class=logo>YY小站</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=/>首页</a></li><li class=menu-item><a class=menu-item-link href=/post/>归档</a></li><li class=menu-item><a class=menu-item-link href=/tags/>标签</a></li><li class=menu-item><a class=menu-item-link href=/categories/>分类</a></li><li class=menu-item><a class=menu-item-link href=/about/>关于</a></li><li class=menu-item><a class=menu-item-link href=/search/>搜索</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>kubeflow安装教程</h1><div class=post-meta><span class=post-time>2023-07-24</span><div class=post-category><a href=/categories/uncategorized/>Uncategorized</a></div><span id=busuanzi_container_page_pv class=more-meta><span id=busuanzi_value_page_pv><img src=/img/spinner.svg alt=spinner.svg></span> times read</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#服务器和软件版本规划>服务器和软件版本规划</a></li><li><a href=#安装k8s集群>安装k8s集群</a><ul><li><a href=#配置sudo用户免密>配置sudo用户免密</a></li><li><a href=#关闭防火墙>关闭防火墙</a></li><li><a href=#安装docker>安装docker</a></li><li><a href=#配置k8s需求>配置k8s需求</a><ul><li><a href=#禁用swap>禁用swap</a></li><li><a href=#允许iptables桥接流量>允许iptables桥接流量</a></li></ul></li><li><a href=#安装rke>安装RKE</a><ul><li><a href=#创建rke用户>创建rke用户</a></li><li><a href=#创建密钥并拷贝>创建密钥并拷贝</a></li><li><a href=#rke创建k8s集群>rke创建k8s集群</a></li><li><a href=#安装kubectl>安装kubectl</a></li></ul></li><li><a href=#安装rancher>安装rancher</a></li></ul></li><li><a href=#安装kubeflow>安装kubeflow</a><ul><li><a href=#安装storageclass>安装storageClass</a></li><li><a href=#安装kustomize>安装kustomize</a></li><li><a href=#下载kubeflow和镜像>下载kubeflow和镜像</a><ul><li><a href=#下载kubeflow>下载kubeflow</a></li><li><a href=#下载相关镜像>下载相关镜像</a></li></ul></li><li><a href=#修改kubeflow默认密码>修改kubeflow默认密码</a></li><li><a href=#一键安装kubeflow>一键安装kubeflow</a></li><li><a href=#安装完成后>安装完成后</a><ul><li><a href=#问题1>问题1</a></li><li><a href=#问题2>问题2</a></li><li><a href=#问题3>问题3</a></li><li><a href=#问题4>问题4</a></li></ul></li></ul></li><li><a href=#安装keepalived>安装keepalived</a></li><li><a href=#安装nfs-server>安装nfs server</a></li><li><a href=#安装harbor>安装harbor</a><ul><li><a href=#安装docker-1>安装docker</a></li><li><a href=#安装docker-compose>安装docker-compose</a></li><li><a href=#开始安装harbor>开始安装harbor</a></li></ul></li></ul></nav></div></div><div class=post-content><h1 id=服务器和软件版本规划>服务器和软件版本规划</h1><pre><code>7台服务器和1个虚拟IP：
172.27.244.151-153(3台master,4C/8G/500GB)
172.27.244.154-156(3台worker,16C/32G/500GB)
172.27.24.150(nfs/harbor,4C/8G/2TB)
172.27.244.160(虚拟IP)

版本：
OS:ubuntu20.04.6
rke:1.4.6  docker:20.10.X(5:20.10.24~3-0~ubuntu-focal)
rancher:2.7.5  k8s:支持1.23-1.26(rancher/hyperkube:v1.26.4-rancher2)
kustomize:5.1.0
kubeflow:1.7.0
</code></pre><h1 id=安装k8s集群>安装k8s集群</h1><p>172.27.244.151-156等6台服务器。</p><p>默认6台服务器都执行，如果只在其中的某些机器执行会说明。</p><h2 id=配置sudo用户免密>配置sudo用户免密</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>echo &#34;$USER   ALL=(ALL:ALL) NOPASSWD:ALL&#34; | sudo tee /etc/sudoers.d/$USER
</span></span></code></pre></td></tr></table></div></div><h2 id=关闭防火墙>关闭防火墙</h2><p>我机器在内网，关闭防火墙省事。放在外网的服务最好开启防火墙，放行端口参考各自业务的官方文档！</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo systemctl stop ufw
</span></span><span class=line><span class=cl>sudo systemctl disable ufw
</span></span></code></pre></td></tr></table></div></div><h2 id=安装docker>安装docker</h2><p><del><a href=https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-requirements/install-docker>https://ranchermanager.docs.rancher.com/getting-started/installation-and-upgrade/installation-requirements/install-docker</a></del></p><p><del>rancher官方有个docker安装脚本</del></p><p>开始安装！</p><p>docker官方文档：https://docs.docker.com/engine/install/ubuntu/</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>sudo</span> <span class=n>apt</span><span class=o>-</span><span class=n>get</span> <span class=n>update</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>apt</span><span class=o>-</span><span class=n>get</span> <span class=n>install</span> <span class=n>ca</span><span class=o>-</span><span class=n>certificates</span> <span class=n>curl</span> <span class=n>gnupg</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>install</span> <span class=o>-</span><span class=n>m</span> <span class=mi>0755</span> <span class=o>-</span><span class=n>d</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>apt</span><span class=o>/</span><span class=n>keyrings</span>
</span></span><span class=line><span class=cl><span class=n>curl</span> <span class=o>-</span><span class=n>fsSL</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>download</span><span class=o>.</span><span class=n>docker</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>linux</span><span class=o>/</span><span class=n>ubuntu</span><span class=o>/</span><span class=n>gpg</span> <span class=o>|</span> <span class=n>sudo</span> <span class=n>gpg</span> <span class=o>--</span><span class=n>dearmor</span> <span class=o>-</span><span class=n>o</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>apt</span><span class=o>/</span><span class=n>keyrings</span><span class=o>/</span><span class=n>docker</span><span class=o>.</span><span class=n>gpg</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>chmod</span> <span class=n>a</span><span class=o>+</span><span class=n>r</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>apt</span><span class=o>/</span><span class=n>keyrings</span><span class=o>/</span><span class=n>docker</span><span class=o>.</span><span class=n>gpg</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>echo</span> \
</span></span><span class=line><span class=cl>  <span class=s2>&#34;deb [arch=&#34;</span><span class=o>$</span><span class=p>(</span><span class=n>dpkg</span> <span class=o>--</span><span class=nb>print</span><span class=o>-</span><span class=n>architecture</span><span class=p>)</span><span class=s2>&#34; signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu </span><span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span><span class=s2>  &#34;</span><span class=o>$</span><span class=p>(</span><span class=o>.</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>os</span><span class=o>-</span><span class=n>release</span> <span class=o>&amp;&amp;</span> <span class=n>echo</span> <span class=s2>&#34;$VERSION_CODENAME&#34;</span><span class=p>)</span><span class=s2>&#34; stable&#34;</span> <span class=o>|</span> \
</span></span><span class=line><span class=cl>  <span class=n>sudo</span> <span class=n>tee</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>apt</span><span class=o>/</span><span class=n>sources</span><span class=o>.</span><span class=n>list</span><span class=o>.</span><span class=n>d</span><span class=o>/</span><span class=n>docker</span><span class=o>.</span><span class=n>list</span> <span class=o>&gt;</span> <span class=o>/</span><span class=n>dev</span><span class=o>/</span><span class=n>null</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>apt</span><span class=o>-</span><span class=n>get</span> <span class=n>update</span>
</span></span><span class=line><span class=cl><span class=n>VERSION_STRING</span><span class=o>=</span><span class=mi>5</span><span class=p>:</span><span class=mf>20.10</span><span class=o>.</span><span class=mi>24</span><span class=o>~</span><span class=mi>3</span><span class=o>-</span><span class=mi>0</span><span class=o>~</span><span class=n>ubuntu</span><span class=o>-</span><span class=n>focal</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>apt</span><span class=o>-</span><span class=n>get</span> <span class=n>install</span> <span class=n>docker</span><span class=o>-</span><span class=n>ce</span><span class=o>=$</span><span class=n>VERSION_STRING</span> <span class=n>docker</span><span class=o>-</span><span class=n>ce</span><span class=o>-</span><span class=n>cli</span><span class=o>=$</span><span class=n>VERSION_STRING</span> <span class=n>containerd</span><span class=o>.</span><span class=n>io</span> <span class=n>docker</span><span class=o>-</span><span class=n>buildx</span><span class=o>-</span><span class=n>plugin</span> <span class=n>docker</span><span class=o>-</span><span class=n>compose</span><span class=o>-</span><span class=n>plugin</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=配置k8s需求>配置k8s需求</h2><p>k8s官方文档：</p><p><a href=https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/>https://kubernetes.io/docs/setup/production-environment/tools/kubeadm/install-kubeadm/</a></p><p><a href=https://kubernetes.io/docs/setup/production-environment/container-runtimes/#install-and-configure-prerequisites>https://kubernetes.io/docs/setup/production-environment/container-runtimes/#install-and-configure-prerequisites</a></p><p>rke官方文档：</p><p><a href=https://rke.docs.rancher.com/os>https://rke.docs.rancher.com/os</a></p><h3 id=禁用swap>禁用swap</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo swapoff -a &amp;&amp; sudo sed -i &#39;/swap/s/^/#/&#39; /etc/fstab
</span></span></code></pre></td></tr></table></div></div><h3 id=允许iptables桥接流量>允许iptables桥接流量</h3><p>确认信息。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>lsmod | grep br_netfilter
</span></span><span class=line><span class=cl>lsmod | grep overlay
</span></span><span class=line><span class=cl>sysctl net.bridge.bridge-nf-call-iptables net.bridge.bridge-nf-call-ip6tables net.ipv4.ip_forward
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>cat</span> <span class=o>&lt;&lt;</span><span class=n>EOF</span> <span class=o>|</span> <span class=n>sudo</span> <span class=n>tee</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>modules</span><span class=o>-</span><span class=nb>load</span><span class=o>.</span><span class=n>d</span><span class=o>/</span><span class=n>k8s</span><span class=o>.</span><span class=n>conf</span>
</span></span><span class=line><span class=cl><span class=n>overlay</span>
</span></span><span class=line><span class=cl><span class=n>br_netfilter</span>
</span></span><span class=line><span class=cl><span class=n>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>modprobe</span> <span class=n>overlay</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>modprobe</span> <span class=n>br_netfilter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>cat</span> <span class=o>&lt;&lt;</span><span class=n>EOF</span> <span class=o>|</span> <span class=n>sudo</span> <span class=n>tee</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>sysctl</span><span class=o>.</span><span class=n>d</span><span class=o>/</span><span class=n>k8s</span><span class=o>.</span><span class=n>conf</span>
</span></span><span class=line><span class=cl><span class=n>net</span><span class=o>.</span><span class=n>bridge</span><span class=o>.</span><span class=n>bridge</span><span class=o>-</span><span class=n>nf</span><span class=o>-</span><span class=n>call</span><span class=o>-</span><span class=n>iptables</span>  <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>net</span><span class=o>.</span><span class=n>bridge</span><span class=o>.</span><span class=n>bridge</span><span class=o>-</span><span class=n>nf</span><span class=o>-</span><span class=n>call</span><span class=o>-</span><span class=n>ip6tables</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>net</span><span class=o>.</span><span class=n>ipv4</span><span class=o>.</span><span class=n>ip_forward</span>                 <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl><span class=n>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>sysctl</span> <span class=o>--</span><span class=n>system</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=安装rke>安装RKE</h2><p>找其中一台机器安装rke工具即可，在172.27.244.151安装rke。</p><p>rke官方文档：https://rke.docs.rancher.com/installation</p><h3 id=创建rke用户>创建rke用户</h3><p>172.27.244.151-156都创建用户，并添加到docker组。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo useradd -m -s /bin/bash rkeuser
</span></span><span class=line><span class=cl>sudo usermod -aG docker rkeuser
</span></span><span class=line><span class=cl>sudo chpasswd &lt;&lt;&lt; &#39;rkeuser:123456&#39;
</span></span></code></pre></td></tr></table></div></div><h3 id=创建密钥并拷贝>创建密钥并拷贝</h3><p>在172.27.244.151上执行，本机rkeuser用户也要拷贝密钥。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>ssh-keygen -qf ~/.ssh/id_rsa -P &#39;&#39;
</span></span><span class=line><span class=cl>ssh-copy-id -f -p 5008 -i ~/.ssh/id_rsa.pub -o StrictHostKeyChecking=no rkeuser@172.27.244.151
</span></span><span class=line><span class=cl>ssh-copy-id -f -p 5008 -i ~/.ssh/id_rsa.pub -o StrictHostKeyChecking=no rkeuser@172.27.244.152
</span></span><span class=line><span class=cl>ssh-copy-id -f -p 5008 -i ~/.ssh/id_rsa.pub -o StrictHostKeyChecking=no rkeuser@172.27.244.153
</span></span><span class=line><span class=cl>ssh-copy-id -f -p 5008 -i ~/.ssh/id_rsa.pub -o StrictHostKeyChecking=no rkeuser@172.27.244.154
</span></span><span class=line><span class=cl>ssh-copy-id -f -p 5008 -i ~/.ssh/id_rsa.pub -o StrictHostKeyChecking=no rkeuser@172.27.244.155
</span></span><span class=line><span class=cl>ssh-copy-id -f -p 5008 -i ~/.ssh/id_rsa.pub -o StrictHostKeyChecking=no rkeuser@172.27.244.156
</span></span></code></pre></td></tr></table></div></div><h3 id=rke创建k8s集群>rke创建k8s集群</h3><p>在172.27.244.151上执行。</p><p>rke下载地址：https://github.com/rancher/rke/releases/tag/v1.4.6</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>cd</span> <span class=o>&amp;&amp;</span> <span class=n>wget</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>rancher</span><span class=o>/</span><span class=n>rke</span><span class=o>/</span><span class=n>releases</span><span class=o>/</span><span class=n>download</span><span class=o>/</span><span class=n>v1</span><span class=o>.</span><span class=mf>4.6</span><span class=o>/</span><span class=n>rke_linux</span><span class=o>-</span><span class=n>amd64</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>mkdir</span> <span class=n>bin</span> <span class=o>&amp;&amp;</span> <span class=n>cp</span> <span class=n>rke_linux</span><span class=o>-</span><span class=n>amd64</span> <span class=n>bin</span> <span class=o>&amp;&amp;</span> <span class=n>chmod</span> <span class=o>+</span><span class=n>x</span> <span class=n>bin</span><span class=o>/</span><span class=n>rke_linux</span><span class=o>-</span><span class=n>amd64</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>ln</span> <span class=o>-</span><span class=n>s</span> <span class=o>$</span><span class=n>HOME</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>rke_linux</span><span class=o>-</span><span class=n>amd64</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>rke</span>
</span></span></code></pre></td></tr></table></div></div><p>配置rke</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>rke config --name cluster.yml
</span></span></code></pre></td></tr></table></div></div><p>默认端口8472与深信服超融合有冲突，修改cluster.yml,参考 <a href=https://rke.docs.rancher.com/config-options/add-ons/network-plugins#flannel>https://rke.docs.rancher.com/config-options/add-ons/network-plugins#flannel</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>network:
</span></span><span class=line><span class=cl>  plugin: flannel
</span></span><span class=line><span class=cl>  options:
</span></span><span class=line><span class=cl>    flannel_backend_type: vxlan
</span></span><span class=line><span class=cl>    flannel_backend_port: &#34;8972&#34;
</span></span></code></pre></td></tr></table></div></div><p>一些常用配置参考：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>network:
</span></span><span class=line><span class=cl>  plugin: canal
</span></span><span class=line><span class=cl>  options:
</span></span><span class=line><span class=cl>    canal_flannel_backend_type: vxlan
</span></span><span class=line><span class=cl>    canal_flannel_backend_port: &#34;8972&#34;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>kubelet:
</span></span><span class=line><span class=cl>    extra_args:
</span></span><span class=line><span class=cl>      max-pods: 250
</span></span></code></pre></td></tr></table></div></div><p>如果使用canal的话还需要修改canal-config</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>kubectl edit configmap canal-config -n kube-system
</span></span></code></pre></td></tr></table></div></div><p>找到如下位置，添加端口号8972</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span><span class=lnt>9
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>data:
</span></span><span class=line><span class=cl>  net-conf.json: |
</span></span><span class=line><span class=cl>    {
</span></span><span class=line><span class=cl>      &#34;Network&#34;: &#34;10.42.0.0/16&#34;,
</span></span><span class=line><span class=cl>      &#34;Backend&#34;: {
</span></span><span class=line><span class=cl>        &#34;Type&#34;: &#34;vxlan&#34;,
</span></span><span class=line><span class=cl>        &#34;Port&#34;: 8972
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    }
</span></span></code></pre></td></tr></table></div></div><p>运行rke</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>rke up
</span></span></code></pre></td></tr></table></div></div><p>常用命令，仅更新，忽略docker版本等</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>rke up --update-only --ignore-docker-version
</span></span></code></pre></td></tr></table></div></div><h3 id=安装kubectl>安装kubectl</h3><p>在172.27.244.151上执行。</p><p>安装kubectl并配置命令自动补全。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>curl -LO &#34;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl&#34;
</span></span><span class=line><span class=cl>sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl
</span></span><span class=line><span class=cl>echo &#39;source &lt;(kubectl completion bash)&#39; &gt;&gt;~/.bashrc &amp;&amp; . ~/.bashrc
</span></span><span class=line><span class=cl>mkdir $HOME/.kube
</span></span><span class=line><span class=cl>cp kube_config_cluster.yml $HOME/.kube/config
</span></span></code></pre></td></tr></table></div></div><h2 id=安装rancher>安装rancher</h2><p>在172.27.244.151上执行。</p><p>官方文档：https://ranchermanager.docs.rancher.com/zh/pages-for-subheaders/install-upgrade-on-a-kubernetes-cluster</p><p>安装helm。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>wget https://get.helm.sh/helm-v3.12.1-linux-amd64.tar.gz
</span></span><span class=line><span class=cl>tar zxf helm-v3.12.1-linux-amd64.tar.gz
</span></span><span class=line><span class=cl>sudo mv linux-amd64/helm /usr/local/bin/helm
</span></span></code></pre></td></tr></table></div></div><p>用helm安装rancher。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>helm</span> <span class=n>repo</span> <span class=n>add</span> <span class=n>rancher</span><span class=o>-</span><span class=n>stable</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>releases</span><span class=o>.</span><span class=n>rancher</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>server</span><span class=o>-</span><span class=n>charts</span><span class=o>/</span><span class=n>stable</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>kubectl</span> <span class=n>create</span> <span class=n>namespace</span> <span class=n>cattle</span><span class=o>-</span><span class=n>system</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#确认v1.12.2版本信息，如有需要可替换</span>
</span></span><span class=line><span class=cl><span class=n>kubectl</span> <span class=n>apply</span> <span class=o>-</span><span class=n>f</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>cert</span><span class=o>-</span><span class=n>manager</span><span class=o>/</span><span class=n>cert</span><span class=o>-</span><span class=n>manager</span><span class=o>/</span><span class=n>releases</span><span class=o>/</span><span class=n>download</span><span class=o>/</span><span class=n>v1</span><span class=o>.</span><span class=mf>12.2</span><span class=o>/</span><span class=n>cert</span><span class=o>-</span><span class=n>manager</span><span class=o>.</span><span class=n>crds</span><span class=o>.</span><span class=n>yaml</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>helm</span> <span class=n>repo</span> <span class=n>add</span> <span class=n>jetstack</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>charts</span><span class=o>.</span><span class=n>jetstack</span><span class=o>.</span><span class=n>io</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>helm</span> <span class=n>repo</span> <span class=n>update</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>helm</span> <span class=n>install</span> <span class=n>cert</span><span class=o>-</span><span class=n>manager</span> <span class=n>jetstack</span><span class=o>/</span><span class=n>cert</span><span class=o>-</span><span class=n>manager</span> \
</span></span><span class=line><span class=cl>  <span class=o>--</span><span class=n>namespace</span> <span class=n>cert</span><span class=o>-</span><span class=n>manager</span> \
</span></span><span class=line><span class=cl>  <span class=o>--</span><span class=n>create</span><span class=o>-</span><span class=n>namespace</span> \
</span></span><span class=line><span class=cl>  <span class=o>--</span><span class=n>version</span> <span class=n>v1</span><span class=o>.</span><span class=mf>12.2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>helm</span> <span class=n>install</span> <span class=n>rancher</span> <span class=n>rancher</span><span class=o>-</span><span class=n>stable</span><span class=o>/</span><span class=n>rancher</span> \
</span></span><span class=line><span class=cl>  <span class=o>--</span><span class=n>namespace</span> <span class=n>cattle</span><span class=o>-</span><span class=n>system</span> \
</span></span><span class=line><span class=cl>  <span class=o>--</span><span class=n>set</span> <span class=n>hostname</span><span class=o>=</span><span class=n>rancher</span><span class=o>-</span><span class=n>ai</span><span class=o>.</span><span class=n>example</span><span class=o>.</span><span class=n>com</span> \
</span></span><span class=line><span class=cl>  <span class=o>--</span><span class=n>set</span> <span class=n>bootstrapPassword</span><span class=o>=</span><span class=mi>123456</span> \
</span></span><span class=line><span class=cl>  <span class=o>--</span><span class=n>set</span> <span class=n>global</span><span class=o>.</span><span class=n>cattle</span><span class=o>.</span><span class=n>psp</span><span class=o>.</span><span class=n>enabled</span><span class=o>=</span><span class=bp>false</span> \
</span></span><span class=line><span class=cl>  <span class=o>--</span><span class=n>version</span> <span class=mf>2.7</span><span class=o>.</span><span class=mi>5</span>
</span></span></code></pre></td></tr></table></div></div><p>安装完，检查rancher状态。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>kubectl -n cattle-system rollout status deploy/rancher
</span></span><span class=line><span class=cl>kubectl -n cattle-system get deploy rancher
</span></span></code></pre></td></tr></table></div></div><p>如有需要，查看密码方法。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>kubectl get secret --namespace cattle-system bootstrap-secret -o go-template=&#39;{{ .data.bootstrapPassword|base64decode}}{{ &#34;\n&#34; }}&#39;
</span></span></code></pre></td></tr></table></div></div><h1 id=安装kubeflow>安装kubeflow</h1><h2 id=安装storageclass>安装storageClass</h2><p>前提条件，在172.27.244.150先安装nfs-server ，再安装存储类nfs-cient-provisioner，在172.27.244.151上执行。</p><p>nfs-cient-provisioner文档：</p><p><a href=https://github.com/kubernetes-sigs/nfs-subdir-external-provisioner>https://github.com/kubernetes-sigs/nfs-subdir-external-provisioner</a></p><p><a href=https://artifacthub.io/packages/helm/nfs-subdir-external-provisioner/nfs-subdir-external-provisioner>https://artifacthub.io/packages/helm/nfs-subdir-external-provisioner/nfs-subdir-external-provisioner</a></p><p>挂载选项相关文档：</p><p><a href=https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/storage_administration_guide/s1-nfs-client-config-options>https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/storage_administration_guide/s1-nfs-client-config-options</a></p><p><a href=https://www.man7.org/linux/man-pages/man5/nfs.5.html>https://www.man7.org/linux/man-pages/man5/nfs.5.html</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>helm repo add nfs-subdir-external-provisioner https://kubernetes-sigs.github.io/nfs-subdir-external-provisioner/
</span></span><span class=line><span class=cl>helm repo update
</span></span><span class=line><span class=cl>helm install nfs-client-provisioner nfs-subdir-external-provisioner/nfs-subdir-external-provisioner \
</span></span><span class=line><span class=cl>    --set nfs.server=172.27.244.150 \
</span></span><span class=line><span class=cl>    --set nfs.path=/data_nfs \
</span></span><span class=line><span class=cl>    --set storageClass.defaultClass=true
</span></span></code></pre></td></tr></table></div></div><p>常用命令参考</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>helm install nfs-client-provisioner-yw ./nfs-subdir-external-provisioner-4.0.12.tgz \
</span></span><span class=line><span class=cl>    --set nfs.server=172.27.244.150 \
</span></span><span class=line><span class=cl>    --set nfs.path=/data/nfs/nfs-client-provisioner \
</span></span><span class=line><span class=cl>    --set image.repository=harbor-ai.example.com/kf1.9/registry.k8s.io/sig-storage/nfs-subdir-external-provisioner \
</span></span><span class=line><span class=cl>    --set image.tag=v4.0.2 \
</span></span><span class=line><span class=cl>    --set storageClass.name=nfs-client \
</span></span><span class=line><span class=cl>    --namespace nfs-client-system
</span></span></code></pre></td></tr></table></div></div><p>默认是拉取v4.0.2，在3台worker服务器执行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker pull strongxyz/nfs-subdir-external-provisioner:v4.0.2
</span></span><span class=line><span class=cl>sudo docker tag strongxyz/nfs-subdir-external-provisioner:v4.0.2 registry.k8s.io/sig-storage/nfs-subdir-external-provisioner:v4.0.2
</span></span></code></pre></td></tr></table></div></div><h2 id=安装kustomize>安装kustomize</h2><p>在172.27.244.151上执行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>wget</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>kubernetes</span><span class=o>-</span><span class=n>sigs</span><span class=o>/</span><span class=n>kustomize</span><span class=o>/</span><span class=n>releases</span><span class=o>/</span><span class=n>download</span><span class=o>/</span><span class=n>kustomize</span><span class=o>/</span><span class=n>v5</span><span class=o>.</span><span class=mf>1.0</span><span class=o>/</span><span class=n>kustomize_v5</span><span class=o>.</span><span class=mf>1.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span>
</span></span><span class=line><span class=cl><span class=n>tar</span> <span class=n>zxf</span> <span class=n>kustomize_v5</span><span class=o>.</span><span class=mf>1.0</span><span class=n>_linux_amd64</span><span class=o>.</span><span class=n>tar</span><span class=o>.</span><span class=n>gz</span> <span class=o>&amp;&amp;</span> <span class=n>cp</span> <span class=n>kustomize</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=下载kubeflow和镜像>下载kubeflow和镜像</h2><p>在172.27.244.151上执行。</p><h3 id=下载kubeflow>下载kubeflow</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>wget https://github.com/kubeflow/manifests/archive/refs/tags/v1.7.0.tar.gz
</span></span><span class=line><span class=cl>tar zxf manifests-1.7.0 &amp;&amp; cd manifests-1.7.0
</span></span></code></pre></td></tr></table></div></div><p>查看需要哪些镜像，国内环境无法访问gcr.io，从国外服务器中转镜像到hub.docker.com（需要自己注册仓库），然后再拉取镜像！</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>kustomize build example &gt; kustomize_build_example.out.txt
</span></span><span class=line><span class=cl>awk -F&#39;: &#39; &#39;/image: gcr.io/{print $2}&#39; kustomize_build_example.out.txt | sort -u &gt; pull.image.list.txt
</span></span></code></pre></td></tr></table></div></div><p>所需镜像列表:</p><pre><code>gcr.io/arrikto/kubeflow/oidc-authservice:e236439
gcr.io/knative-releases/knative.dev/eventing/cmd/controller@sha256:33d78536e9b38dbb2ec2952207b48ff8e05acb48e7d28c2305bd0a0f7156198f
gcr.io/knative-releases/knative.dev/eventing/cmd/mtping@sha256:282b5265e1ef26309b3343038c9b4f172654e06cbee46f6ddffd23ea9ad9a3be
gcr.io/knative-releases/knative.dev/eventing/cmd/webhook@sha256:d217ab7e3452a87f8cbb3b45df65c98b18b8be39551e3e960cd49ea44bb415ba
gcr.io/knative-releases/knative.dev/net-istio/cmd/controller@sha256:2b484d982ef1a5d6ff93c46d3e45f51c2605c2e3ed766e20247d1727eb5ce918
gcr.io/knative-releases/knative.dev/net-istio/cmd/webhook@sha256:59b6a46d3b55a03507c76a3afe8a4ee5f1a38f1130fd3d65c9fe57fff583fa8d
gcr.io/knative-releases/knative.dev/serving/cmd/activator@sha256:c3bbf3a96920048869dcab8e133e00f59855670b8a0bbca3d72ced2f512eb5e1
gcr.io/knative-releases/knative.dev/serving/cmd/autoscaler@sha256:caae5e34b4cb311ed8551f2778cfca566a77a924a59b775bd516fa8b5e3c1d7f
gcr.io/knative-releases/knative.dev/serving/cmd/controller@sha256:38f9557f4d61ec79cc2cdbe76da8df6c6ae5f978a50a2847c22cc61aa240da95
gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping@sha256:763d648bf1edee2b4471b0e211dbc53ba2d28f92e4dae28ccd39af7185ef2c96
gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping-webhook@sha256:a4ba0076df2efaca2eed561339e21b3a4ca9d90167befd31de882bff69639470
gcr.io/knative-releases/knative.dev/serving/cmd/queue@sha256:505179c0c4892ea4a70e78bc52ac21b03cd7f1a763d2ecc78e7bbaa1ae59c86c
gcr.io/knative-releases/knative.dev/serving/cmd/webhook@sha256:bc13765ba4895c0fa318a065392d05d0adc0e20415c739e0aacb3f56140bf9ae
gcr.io/kubebuilder/kube-rbac-proxy:v0.13.1
gcr.io/kubebuilder/kube-rbac-proxy:v0.8.0
gcr.io/ml-pipeline/api-server:2.0.0-alpha.7
gcr.io/ml-pipeline/cache-server:2.0.0-alpha.7
gcr.io/ml-pipeline/frontend
gcr.io/ml-pipeline/frontend:2.0.0-alpha.7
gcr.io/ml-pipeline/metadata-envoy:2.0.0-alpha.7
gcr.io/ml-pipeline/metadata-writer:2.0.0-alpha.7
gcr.io/ml-pipeline/minio:RELEASE.2019-08-14T20-37-41Z-license-compliance
gcr.io/ml-pipeline/mysql:8.0.26
gcr.io/ml-pipeline/persistenceagent:2.0.0-alpha.7
gcr.io/ml-pipeline/scheduledworkflow:2.0.0-alpha.7
gcr.io/ml-pipeline/viewer-crd-controller:2.0.0-alpha.7
gcr.io/ml-pipeline/visualization-server
gcr.io/ml-pipeline/visualization-server:2.0.0-alpha.7
gcr.io/ml-pipeline/workflow-controller:v3.3.8-license-compliance
gcr.io/tfx-oss-public/ml_metadata_store_server:1.5.0
</code></pre><h3 id=下载相关镜像>下载相关镜像</h3><p>下载镜像并推送到hub.docker.com个人仓库(脚本中未放docker login，登录后再执行即可，也可以把登录放入脚本中)。</p><p>hub.docker.com仓库需要自行注册</p><p>在能访问gcr.io的服务器上执行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>a=(
</span></span><span class=line><span class=cl>gcr.io/arrikto/kubeflow/oidc-authservice:e236439
</span></span><span class=line><span class=cl>gcr.io/kubebuilder/kube-rbac-proxy:v0.13.1
</span></span><span class=line><span class=cl>gcr.io/kubebuilder/kube-rbac-proxy:v0.8.0
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/api-server:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/cache-server:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/frontend
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/frontend:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/metadata-envoy:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/metadata-writer:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/minio:RELEASE.2019-08-14T20-37-41Z-license-compliance
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/mysql:8.0.26
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/persistenceagent:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/scheduledworkflow:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/viewer-crd-controller:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/visualization-server
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/visualization-server:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/workflow-controller:v3.3.8-license-compliance
</span></span><span class=line><span class=cl>gcr.io/tfx-oss-public/ml_metadata_store_server:1.5.0
</span></span><span class=line><span class=cl>)
</span></span><span class=line><span class=cl>b=(${a[*]//gcr.io*\//strongxyz/})
</span></span><span class=line><span class=cl>for ((i=0; i&lt;${#a[*]}; i++)); do
</span></span><span class=line><span class=cl>    sudo docker pull &#34;${a[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker tag &#34;${a[i]}&#34; &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker push &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker rmi &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker rmi &#34;${a[i]}&#34;
</span></span><span class=line><span class=cl>done
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>a=(
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/eventing/cmd/controller@sha256:33d78536e9b38dbb2ec2952207b48ff8e05acb48e7d28c2305bd0a0f7156198f
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/eventing/cmd/mtping@sha256:282b5265e1ef26309b3343038c9b4f172654e06cbee46f6ddffd23ea9ad9a3be
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/eventing/cmd/webhook@sha256:d217ab7e3452a87f8cbb3b45df65c98b18b8be39551e3e960cd49ea44bb415ba
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/net-istio/cmd/controller@sha256:2b484d982ef1a5d6ff93c46d3e45f51c2605c2e3ed766e20247d1727eb5ce918
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/net-istio/cmd/webhook@sha256:59b6a46d3b55a03507c76a3afe8a4ee5f1a38f1130fd3d65c9fe57fff583fa8d
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/activator@sha256:c3bbf3a96920048869dcab8e133e00f59855670b8a0bbca3d72ced2f512eb5e1
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/autoscaler@sha256:caae5e34b4cb311ed8551f2778cfca566a77a924a59b775bd516fa8b5e3c1d7f
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/controller@sha256:38f9557f4d61ec79cc2cdbe76da8df6c6ae5f978a50a2847c22cc61aa240da95
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping@sha256:763d648bf1edee2b4471b0e211dbc53ba2d28f92e4dae28ccd39af7185ef2c96
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping-webhook@sha256:a4ba0076df2efaca2eed561339e21b3a4ca9d90167befd31de882bff69639470
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/queue@sha256:505179c0c4892ea4a70e78bc52ac21b03cd7f1a763d2ecc78e7bbaa1ae59c86c
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/webhook@sha256:bc13765ba4895c0fa318a065392d05d0adc0e20415c739e0aacb3f56140bf9ae
</span></span><span class=line><span class=cl>)
</span></span><span class=line><span class=cl>b=(
</span></span><span class=line><span class=cl>strongxyz/eventing_cmd_controller:sha256
</span></span><span class=line><span class=cl>strongxyz/eventing_cmd_mtping:sha256
</span></span><span class=line><span class=cl>strongxyz/eventing_cmd_webhook:sha256
</span></span><span class=line><span class=cl>strongxyz/net-istio_cmd_controller:sha256
</span></span><span class=line><span class=cl>strongxyz/net-istio_cmd_webhook:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_activator:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_autoscaler:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_controller:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_domain-mapping:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_domain-mapping-webhook:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_queue:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_webhook:sha256
</span></span><span class=line><span class=cl>)
</span></span><span class=line><span class=cl>for ((i=0; i&lt;${#a[*]}; i++)); do
</span></span><span class=line><span class=cl>    sudo docker pull &#34;${a[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker tag &#34;${a[i]}&#34; &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker push &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker rmi &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker rmi &#34;${a[i]}&#34;
</span></span><span class=line><span class=cl>done
</span></span></code></pre></td></tr></table></div></div><p>在172.27.244.154-156等3台worker机器执行，拉取镜像，重新打tag。如果master也是worker节点，master也需要拉取镜像。</p><p>拉取镜像不需要登录。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>a=(
</span></span><span class=line><span class=cl>gcr.io/arrikto/kubeflow/oidc-authservice:e236439
</span></span><span class=line><span class=cl>gcr.io/kubebuilder/kube-rbac-proxy:v0.13.1
</span></span><span class=line><span class=cl>gcr.io/kubebuilder/kube-rbac-proxy:v0.8.0
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/api-server:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/cache-server:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/frontend
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/frontend:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/metadata-envoy:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/metadata-writer:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/minio:RELEASE.2019-08-14T20-37-41Z-license-compliance
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/mysql:8.0.26
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/persistenceagent:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/scheduledworkflow:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/viewer-crd-controller:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/visualization-server
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/visualization-server:2.0.0-alpha.7
</span></span><span class=line><span class=cl>gcr.io/ml-pipeline/workflow-controller:v3.3.8-license-compliance
</span></span><span class=line><span class=cl>gcr.io/tfx-oss-public/ml_metadata_store_server:1.5.0
</span></span><span class=line><span class=cl>)
</span></span><span class=line><span class=cl>b=(${a[*]//gcr.io*\//strongxyz/})
</span></span><span class=line><span class=cl>for ((i=0; i&lt;${#a[*]}; i++)); do
</span></span><span class=line><span class=cl>    sudo docker pull &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker tag &#34;${b[i]}&#34; &#34;${a[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker rmi &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>done
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>a=(
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/eventing/cmd/controller:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/eventing/cmd/mtping:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/eventing/cmd/webhook:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/net-istio/cmd/controller:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/net-istio/cmd/webhook:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/activator:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/autoscaler:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/controller:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping-webhook:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/queue:sha256
</span></span><span class=line><span class=cl>gcr.io/knative-releases/knative.dev/serving/cmd/webhook:sha256
</span></span><span class=line><span class=cl>)
</span></span><span class=line><span class=cl>b=(
</span></span><span class=line><span class=cl>strongxyz/eventing_cmd_controller:sha256
</span></span><span class=line><span class=cl>strongxyz/eventing_cmd_mtping:sha256
</span></span><span class=line><span class=cl>strongxyz/eventing_cmd_webhook:sha256
</span></span><span class=line><span class=cl>strongxyz/net-istio_cmd_controller:sha256
</span></span><span class=line><span class=cl>strongxyz/net-istio_cmd_webhook:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_activator:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_autoscaler:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_controller:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_domain-mapping:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_domain-mapping-webhook:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_queue:sha256
</span></span><span class=line><span class=cl>strongxyz/serving_cmd_webhook:sha256
</span></span><span class=line><span class=cl>)
</span></span><span class=line><span class=cl>for ((i=0; i&lt;${#a[*]}; i++)); do
</span></span><span class=line><span class=cl>    sudo docker pull &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker tag &#34;${b[i]}&#34; &#34;${a[i]}&#34;
</span></span><span class=line><span class=cl>    sudo docker rmi &#34;${b[i]}&#34;
</span></span><span class=line><span class=cl>done
</span></span></code></pre></td></tr></table></div></div><p>vi example/kustomization.yaml，最后添加以下内容。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>images:
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/eventing/cmd/controller@sha256:33d78536e9b38dbb2ec2952207b48ff8e05acb48e7d28c2305bd0a0f7156198f
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/eventing/cmd/controller
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/eventing/cmd/mtping@sha256:282b5265e1ef26309b3343038c9b4f172654e06cbee46f6ddffd23ea9ad9a3be
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/eventing/cmd/mtping
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/eventing/cmd/webhook@sha256:d217ab7e3452a87f8cbb3b45df65c98b18b8be39551e3e960cd49ea44bb415ba
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/eventing/cmd/webhook
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/net-istio/cmd/controller@sha256:2b484d982ef1a5d6ff93c46d3e45f51c2605c2e3ed766e20247d1727eb5ce918
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/net-istio/cmd/controller
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/net-istio/cmd/webhook@sha256:59b6a46d3b55a03507c76a3afe8a4ee5f1a38f1130fd3d65c9fe57fff583fa8d
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/net-istio/cmd/webhook
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/serving/cmd/activator@sha256:c3bbf3a96920048869dcab8e133e00f59855670b8a0bbca3d72ced2f512eb5e1
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/serving/cmd/activator
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/serving/cmd/autoscaler@sha256:caae5e34b4cb311ed8551f2778cfca566a77a924a59b775bd516fa8b5e3c1d7f
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/serving/cmd/autoscaler
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/serving/cmd/controller@sha256:38f9557f4d61ec79cc2cdbe76da8df6c6ae5f978a50a2847c22cc61aa240da95
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/serving/cmd/controller
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping@sha256:763d648bf1edee2b4471b0e211dbc53ba2d28f92e4dae28ccd39af7185ef2c96
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping-webhook@sha256:a4ba0076df2efaca2eed561339e21b3a4ca9d90167befd31de882bff69639470
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/serving/cmd/domain-mapping-webhook
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/serving/cmd/queue@sha256:505179c0c4892ea4a70e78bc52ac21b03cd7f1a763d2ecc78e7bbaa1ae59c86c
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/serving/cmd/queue
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span><span class=line><span class=cl>  - name: gcr.io/knative-releases/knative.dev/serving/cmd/webhook@sha256:bc13765ba4895c0fa318a065392d05d0adc0e20415c739e0aacb3f56140bf9ae
</span></span><span class=line><span class=cl>    newName: gcr.io/knative-releases/knative.dev/serving/cmd/webhook
</span></span><span class=line><span class=cl>    newTag: &#34;sha256&#34;
</span></span></code></pre></td></tr></table></div></div><h2 id=修改kubeflow默认密码>修改kubeflow默认密码</h2><p>随便找台有python3的机器执行都可以，这里在172.27.244.151上执行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt install python3-pip
</span></span><span class=line><span class=cl>sudo pip3 install passlib
</span></span><span class=line><span class=cl>python3 -c &#39;from passlib.hash import bcrypt; import getpass; print(bcrypt.using(rounds=12, ident=&#34;2y&#34;).hash(getpass.getpass()))&#39;
</span></span></code></pre></td></tr></table></div></div><p>以上为交互式命令，输入密码，返回hash值。</p><p>123456</p><p>$2y$12$cDyyBfNqBDpQ9kkRoJYSI.xWggu2r9iHj1234GuTFddJkaWZu3a33</p><p>vi common/dex/base/config-map.yaml，修改对应内容。</p><h2 id=一键安装kubeflow>一键安装kubeflow</h2><p>不同版本，此安装脚本示例会有些不同，具体请参考 <a href="https://github.com/kubeflow/manifests?tab=readme-ov-file#install-with-a-single-command">https://github.com/kubeflow/manifests?tab=readme-ov-file#install-with-a-single-command</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>while ! kustomize build example | awk &#39;!/well-defined/&#39; | kubectl apply -f -; do echo &#34;Retrying to apply resources&#34;; sleep 10; done
</span></span></code></pre></td></tr></table></div></div><h2 id=安装完成后>安装完成后</h2><h3 id=问题1>问题1</h3><p>pod报错：</p><p>error: resource mapping not found for name: &ldquo;webhook&rdquo; namespace: &ldquo;knative-serving&rdquo; from &ldquo;STDIN&rdquo;: no matches for kind &ldquo;HorizontalPodAutoscaler&rdquo; in version &ldquo;autoscaling/v2beta2&rdquo;</p><p>原因：</p><p><a href=https://kubernetes.io/docs/reference/using-api/deprecation-guide/#horizontalpodautoscaler-v125>https://kubernetes.io/docs/reference/using-api/deprecation-guide/#horizontalpodautoscaler-v125</a></p><p><a href=https://www.kubeflow.org/docs/releases/kubeflow-1.7/#dependency-versions-manifests>https://www.kubeflow.org/docs/releases/kubeflow-1.7/#dependency-versions-manifests</a></p><p>解决办法：</p><p>修改common/knative/knative-serving/base/upstream/serving-core.yaml对应的镜像autoscaling/v2</p><h3 id=问题2>问题2</h3><p>有些镜像拉取策略需要修改成IfNotPresent，如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>common/oidc-authservice/base/statefulset.yaml
</span></span><span class=line><span class=cl>apps/pipeline/upstream/base/pipeline/ml-pipeline-viewer-crd-deployment.yaml
</span></span><span class=line><span class=cl>apps/pipeline/upstream/base/cache/cache-deployment.yaml
</span></span></code></pre></td></tr></table></div></div><h3 id=问题3>问题3</h3><p>有些只有一个副本，避免下次运行在另一台worker机器又去拉取镜像，3台worker都拉取以下镜像。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo docker pull kubeflowkatib/katib-db-manager:v0.15.0
</span></span><span class=line><span class=cl>sudo docker pull mysql:8.0.29
</span></span><span class=line><span class=cl>sudo docker pull python:3.7
</span></span></code></pre></td></tr></table></div></div><h3 id=问题4>问题4</h3><p>mysql的pod报错 chown: changing ownership of &lsquo;/var/lib/mysql/&rsquo;: Operation not permitted</p><p>解决：</p><p>修改nfs-server，把all_squash改成no_root_squash</p><p>sudo vi /etc/exports</p><p>sudo exportfs -a</p><p>安装nfs-server时就用no_root_squash，避免此问题产生。</p><h1 id=安装keepalived>安装keepalived</h1><p>找两台机器安装keepalived，这里选在172.27.244.152-153上安装。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo apt -y install nginx keepalived
</span></span></code></pre></td></tr></table></div></div><p>nginx配置：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo rm /etc/nginx/sites-enabled/default
</span></span><span class=line><span class=cl>sudo cp /etc/nginx/nginx.conf{,.bak}
</span></span><span class=line><span class=cl>sudo vi /etc/nginx/nginx.conf
</span></span></code></pre></td></tr></table></div></div><p>配置参考：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>stream {
</span></span><span class=line><span class=cl>        upstream k8s-80 {
</span></span><span class=line><span class=cl>            least_conn;
</span></span><span class=line><span class=cl>            server 172.27.244.154:80 max_fails=3 fail_timeout=5s;
</span></span><span class=line><span class=cl>            server 172.27.244.155:80 max_fails=3 fail_timeout=5s;
</span></span><span class=line><span class=cl>            server 172.27.244.156:80 max_fails=3 fail_timeout=5s;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        upstream k8s-443 {
</span></span><span class=line><span class=cl>            least_conn;
</span></span><span class=line><span class=cl>            server 172.27.244.154:443 max_fails=3 fail_timeout=5s;
</span></span><span class=line><span class=cl>            server 172.27.244.155:443 max_fails=3 fail_timeout=5s;
</span></span><span class=line><span class=cl>            server 172.27.244.156:443 max_fails=3 fail_timeout=5s;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        server {
</span></span><span class=line><span class=cl>            listen 80;
</span></span><span class=line><span class=cl>            proxy_pass k8s-80;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        server {
</span></span><span class=line><span class=cl>            listen 443;
</span></span><span class=line><span class=cl>            proxy_pass k8s-443;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>sudo</span> <span class=n>nginx</span> <span class=o>-</span><span class=n>t</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>nginx</span> <span class=o>-</span><span class=n>s</span> <span class=n>reload</span>
</span></span></code></pre></td></tr></table></div></div><p>keepalived配置：</p><p><a href=https://manpages.debian.org/unstable/keepalived/keepalived.conf.5.en.html>https://manpages.debian.org/unstable/keepalived/keepalived.conf.5.en.html</a></p><p><a href=https://manpages.ubuntu.com/manpages/focal/man5/keepalived.conf.5.html>https://manpages.ubuntu.com/manpages/focal/man5/keepalived.conf.5.html</a></p><p><a href=https://keepalived.readthedocs.io/en/latest/configuration_synopsis.html#global-definitions-synopsis>https://keepalived.readthedocs.io/en/latest/configuration_synopsis.html#global-definitions-synopsis</a></p><p><a href=https://github.com/acassen/keepalived/tree/master/doc/samples>https://github.com/acassen/keepalived/tree/master/doc/samples</a></p><p>/usr/share/doc/keepalived/samples/keepalived.conf.vrrp.localcheck</p><p>/usr/share/doc/keepalived/samples/keepalived.conf.vrrp</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo vi /etc/keepalived/keepalived.conf
</span></span></code></pre></td></tr></table></div></div><p>配置参考，两台机器IP对换一下即可，另一台机器配置<code>state BACKUP</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>global_defs {
</span></span><span class=line><span class=cl>   script_user root
</span></span><span class=line><span class=cl>   enable_script_security
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>vrrp_script chk_nginx {
</span></span><span class=line><span class=cl>    script &#34;killall -0 nginx&#34;
</span></span><span class=line><span class=cl>    interval 2
</span></span><span class=line><span class=cl>    weight 2
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>vrrp_instance VI_1 {
</span></span><span class=line><span class=cl>    state MASTER
</span></span><span class=line><span class=cl>    interface ens18
</span></span><span class=line><span class=cl>    garp_master_delay 10  #default
</span></span><span class=line><span class=cl>    #smtp_alert  #是否发送邮件
</span></span><span class=line><span class=cl>    virtual_router_id 55
</span></span><span class=line><span class=cl>    priority 100  #实例优先级
</span></span><span class=line><span class=cl>    advert_int 1
</span></span><span class=line><span class=cl>    authentication {
</span></span><span class=line><span class=cl>        auth_type PASS
</span></span><span class=line><span class=cl>        auth_pass 00002023
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    unicast_src_ip 172.27.244.152
</span></span><span class=line><span class=cl>    unicast_peer {  #单播
</span></span><span class=line><span class=cl>        172.27.244.153
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    virtual_ipaddress {
</span></span><span class=line><span class=cl>        172.27.244.160/24 dev ens18
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    track_script {
</span></span><span class=line><span class=cl>       chk_nginx
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sudo systemctl restart keepalived
</span></span></code></pre></td></tr></table></div></div><p>域名解析：</p><p>172.27.244.160 rancher-ai.example.com</p><p>172.27.244.160 kubeflow-ai.example.com</p><h1 id=安装nfs-server>安装nfs server</h1><p>在172.27.244.150执行。</p><p>安装。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>sudo</span> <span class=n>apt</span> <span class=o>-</span><span class=n>y</span> <span class=n>install</span> <span class=n>nfs</span><span class=o>-</span><span class=n>kernel</span><span class=o>-</span><span class=n>server</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>mkdir</span> <span class=o>/</span><span class=n>data_nfs</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>chown</span> <span class=mf>1000.1000</span> <span class=o>/</span><span class=n>data_nfs</span>
</span></span><span class=line><span class=cl><span class=n>echo</span> <span class=s1>&#39;/data_nfs 172.27.244.0/24(rw,sync,insecure,no_subtree_check,no_root_squash,no_all_squash,anonuid=1000,anongid=1000)&#39;</span> <span class=o>|</span> <span class=n>sudo</span> <span class=n>tee</span> <span class=o>-</span><span class=n>a</span> <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>exports</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>exportfs</span> <span class=o>-</span><span class=n>a</span>
</span></span></code></pre></td></tr></table></div></div><p>检查nfs状态。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>systemctl</span> <span class=n>status</span> <span class=n>nfs</span><span class=o>-</span><span class=n>server</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>rpcinfo</span> <span class=o>-</span><span class=n>p</span> <span class=o>|</span> <span class=n>grep</span> <span class=n>nfs</span>
</span></span><span class=line><span class=cl><span class=n>cat</span> <span class=o>/</span><span class=k>var</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>nfs</span><span class=o>/</span><span class=n>etab</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>exportfs</span>
</span></span></code></pre></td></tr></table></div></div><h1 id=安装harbor>安装harbor</h1><p>在172.27.244.150执行。</p><h2 id=安装docker-1>安装docker</h2><p>版本换成<code>5:23.0.6-1~ubuntu.20.04~focal</code>，也可以不带版本号安装最新版本，其它略。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>#查看可安装版本
</span></span><span class=line><span class=cl>apt-cache madison docker-ce
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>VERSION_STRING=5:23.0.6-1~ubuntu.20.04~focal
</span></span><span class=line><span class=cl>sudo apt-get install docker-ce=$VERSION_STRING docker-ce-cli=$VERSION_STRING containerd.io docker-buildx-plugin docker-compose-plugin
</span></span></code></pre></td></tr></table></div></div><h2 id=安装docker-compose>安装docker-compose</h2><p>版本号v2.20.1需要自行确认，可以安装当前最新版本。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>sudo</span> <span class=n>curl</span> <span class=o>-</span><span class=n>L</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>docker</span><span class=o>/</span><span class=n>compose</span><span class=o>/</span><span class=n>releases</span><span class=o>/</span><span class=n>download</span><span class=o>/</span><span class=n>v2</span><span class=o>.</span><span class=mf>20.1</span><span class=o>/</span><span class=n>docker</span><span class=o>-</span><span class=n>compose</span><span class=o>-</span><span class=n>linux</span><span class=o>-</span><span class=n>x86_64</span> <span class=o>-</span><span class=n>o</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>docker</span><span class=o>-</span><span class=n>compose</span>
</span></span><span class=line><span class=cl><span class=n>sudo</span> <span class=n>chmod</span> <span class=o>+</span><span class=n>x</span> <span class=o>/</span><span class=n>usr</span><span class=o>/</span><span class=n>local</span><span class=o>/</span><span class=n>bin</span><span class=o>/</span><span class=n>docker</span><span class=o>-</span><span class=n>compose</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=开始安装harbor>开始安装harbor</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=n>wget</span> <span class=n>https</span><span class=p>:</span><span class=o>//</span><span class=n>github</span><span class=o>.</span><span class=n>com</span><span class=o>/</span><span class=n>goharbor</span><span class=o>/</span><span class=n>harbor</span><span class=o>/</span><span class=n>releases</span><span class=o>/</span><span class=n>download</span><span class=o>/</span><span class=n>v2</span><span class=o>.</span><span class=mf>8.2</span><span class=o>/</span><span class=n>harbor</span><span class=o>-</span><span class=n>offline</span><span class=o>-</span><span class=n>installer</span><span class=o>-</span><span class=n>v2</span><span class=o>.</span><span class=mf>8.2</span><span class=o>.</span><span class=n>tgz</span>
</span></span></code></pre></td></tr></table></div></div><p>略&mldr;</p></div><div class=post-copyright><p class=copyright-item><span class=item-title>Author</span>
<span class=item-content>info@yanyong.cc</span></p><p class=copyright-item><span class=item-title>LastMod</span>
<span class=item-content>2023-07-24</span></p><p class=copyright-item><span class=item-title>License</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></p></div><footer class=post-footer><div class=post-tags><a href=/tags/kubeflow/>kubeflow</a></div><nav class=post-nav><a class=prev href=/post/fuck-lvm/><i class="iconfont icon-left"></i>
<span class="prev-text nav-default">Fuck lvm</span>
<span class="prev-text nav-mobile">Prev</span>
</a><a class=next href=/post/vcpkgstaticlink/><span class="next-text nav-default">vcpkg静态链接libcurl</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article></div><script src=https://utteranc.es/client.js repo=onegit20/utterances issue-term=pathname theme=github-light crossorigin=anonymous async></script><noscript>Please enable JavaScript to view the <a href=https://github.com/utterance>comments powered by utterances.</a></noscript></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:info@yanyong.cc class="iconfont icon-email" title=email></a><a href=https://stackoverflow.com/users/16859626/yanyong class="iconfont icon-stack-overflow" title=stack-overflow></a><a href=https://github.com/onegit20 class="iconfont icon-github" title=github></a></div><div class=copyright><div class=busuanzi-footer><span id=busuanzi_container_site_pv>site pv: <span id=busuanzi_value_site_pv><img src=/img/spinner.svg alt=spinner.svg></span> </span><span class=division>|</span>
<span id=busuanzi_container_site_uv>site uv: <span id=busuanzi_value_site_uv><img src=/img/spinner.svg alt=spinner.svg></span></span></div><span class=copyright-year>&copy;
&nbsp;2025&nbsp;
<span>yanyong.cc</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://testingcf.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://testingcf.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://testingcf.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=/js/main.min.4ae89da218555efa0e7093a20b92017d2e1202b66fff9fc2edf4cb8d44b44c6e.js></script><script id=baidu_push>(function(){if(window.location.hostname==="localhost")return;var t,n,e=document.createElement("script");e.async=!0,n=window.location.protocol.split(":")[0],n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script></body></html>